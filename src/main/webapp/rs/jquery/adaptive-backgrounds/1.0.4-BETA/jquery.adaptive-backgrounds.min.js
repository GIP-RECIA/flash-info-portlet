var adaptiveBackgroundApp=adaptiveBackgroundApp||{};adaptiveBackgroundApp.init=function(a){var r={selector:"[data-adaptive-background]",parent:null,exclude:["rgb(0,0,0)","rgb(255,255,255)"],shadeVariation:!1,shadePercentage:0,shadeColors:{light:"rgb(255,255,255)",dark:"rgb(0,0,0)"},normalizeTextColor:!1,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"},transparent:null};function t(a,r){var t=a.split(","),e=r<0?0:255,n=r<0?-1*r:r,o=parseInt(t[0].slice(4)),s=parseInt(t[1]),c=parseInt(t[2]);return"rgb("+(Math.round((e-o)*n)+o)+","+(Math.round((e-s)*n)+s)+","+(Math.round((e-c)*n)+c)+")"}function e(a,r,t){var e=a.split(","),n=r.split(","),o=parseInt(e[0].slice(4)),s=parseInt(e[1]),c=parseInt(e[2]);return"rgb("+(Math.round((parseInt(n[0].slice(4))-o)*t)+o)+","+(Math.round((parseInt(n[1])-s)*t)+s)+","+(Math.round((parseInt(n[2])-c)*t)+c)+")"}!function(a,r){"use strict";var t=function(a,r){var t=new Image,e=a.src||a;"data:"!==e.substring(0,5)&&(t.crossOrigin="Anonymous"),t.onload=function(){var a=function(a,r){var t=document.createElement("canvas");return t.setAttribute("width",a),t.setAttribute("height",r),t.getContext("2d")}(t.width,t.height);a.drawImage(t,0,0);var e=a.getImageData(0,0,t.width,t.height);r&&r(e.data)},t.src=e},e=function(a){return["rgb(",a,")"].join("")},n=function(a){var r=[];for(var t in a)r.push(s(t,a[t]));return r.sort(function(a,r){return r.count-a.count}),r},o=function(a,r){if(a.length>r)return a.slice(0,r);for(var t=a.length-1;r-1>t;t++)a.push(s("0,0,0",0));return a},s=function(a,r){return{name:e(a),count:r}},c={colors:function(a,r){var s=(r=r||{}).exclude||[],c=r.paletteSize||10;t(a,function(a){for(var t={},i="",u=[],l=0;l<a.length;l+=4)u[0]=a[l],u[1]=a[l+1],u[2]=a[l+2],i=u.join(","),-1===u.indexOf(void 0)&&0!==a[l+3]&&-1===s.indexOf(e(i))&&(t[i]=i in t?t[i]+1:1);if(r.success){var d=o(n(t),c+1);r.success({dominant:d[0].name,secondary:d[1].name,palette:d.map(function(a){return a.name}).slice(1)})}})}};a.RGBaster=a.RGBaster||c}(window),a.adaptiveBackground={run:function(n){var o=a.extend({},r,n);a(o.selector).each(function(r,n){var s=a(this),c=function(a){var r=a.match(/\d+/g);return(299*r[0]+587*r[1]+114*r[2])/1e3},i=function(){var a=s.attr("data-ab-css-background");return void 0!==a&&!1!==a},u=function(){var a=s.css("background-image");return/\(([^)]+)\)/.exec(a)[1].replace(/"/g,"")};s.on("ab-color-found",function(r,n){var u,l;if(u=o.parent&&s.parents(o.parent).length?s.parents(o.parent):s.attr("data-ab-parent")&&s.parents(s.attr("data-ab-parent")).length?s.parents(s.attr("data-ab-parent")):i()?s:o.parent?s.parents(o.parent):s.parent(),o.shadeVariation&&(n.color=(l=n.color,1==o.shadeVariation?c(l)<=128?t(l,o.shadePercentage):t(l,-o.shadePercentage,o.shadePercentage):"blend"==o.shadeVariation?c(l)>=128?e(l,o.shadeColors.dark,o.shadePercentage):e(l,o.shadeColors.light,o.shadePercentage):void 0)),a.isNumeric(o.transparent)&&null!=o.transparent&&o.transparent>=.01&&o.transparent<=.99){var d=n.color.replace("rgb","rgba").replace(")",", "+o.transparent+")");u.css({backgroundColor:d})}else u.css({backgroundColor:n.color});o.normalizeTextColor&&u.css({color:function(a){return c(a)>=128?o.normalizedTextColors.dark:o.normalizedTextColors.light}(n.color)}),u.addClass(function(a){return c(a)<=128?o.lumaClasses.dark:o.lumaClasses.light}(n.color)).attr("data-ab-yaq",c(n.color)),o.success&&o.success(s,n)}),function(){if("PICTURE"==s[0].tagName){var a=s[0].children;for(var r in a)if("IMG"==a[r].tagName){var t=a[r];break}t.currentSrc&&(t=t.currentSrc)}else t=i()?u():s[0];RGBaster.colors(t,{paletteSize:20,exclude:o.exclude,success:function(a){s.attr("data-ab-color",a.dominant),s.trigger("ab-color-found",{color:a.dominant,palette:a.palette})}})}()})}}};